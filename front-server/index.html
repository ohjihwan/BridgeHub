<!doctype html>
<html lang="ko">
<head>
	<meta charset="UTF-8" />
	<link rel="icon" type="image/svg+xml" href="/logo.svg" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<title>BridgeHub</title>
</head>
<body>
	<div id="root"></div>
	<div id="alert-root"></div>
	<script type="module" src="src/main.jsx"></script>
</body>
</html>


<!-- 
=============================================
TheBridgeHub API 명세서 (v1.0.0)
=============================================

기본 서버 정보:
- 베이스 URL: http://localhost:7100
- Content-Type: application/json
- Authorization: Bearer {JWT_TOKEN} (인증이 필요한 API)

=============================================
1. FRONT-SERVER 용 API (@/front-server)
=============================================

-------------------------------------------
1.2 스터디룸 관련 API (StudyRoomController)
-------------------------------------------

3) 스터디룸 생성
- URL: POST /api/studies
- 설명: 새 스터디룸 생성
- Headers: Authorization: Bearer {JWT_TOKEN}
- Request Body:
{
    "title": "리액트 스터디",
    "description": "리액트 실전 프로젝트",
    "education": "대학교",
    "department": "컴퓨터공학과",
    "region": "서울",
    "district": "강남구",
    "capacity": 8,
    "time": "저녁",
    "thumbnail": "react_thumbnail.jpg",
    "isPublic": true
}
- Response: 생성된 스터디룸 정보

6) 스터디 참가 신청
- URL: POST /api/studies/{studyRoomId}/join
- 설명: 스터디 참가 신청
- Headers: Authorization: Bearer {JWT_TOKEN}
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": null
}

7) 스터디 멤버 조회
- URL: GET /api/studies/{studyRoomId}/members
- 설명: 스터디룸 참여 멤버 목록 조회
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": [
        {
            "id": 1,
            "studyRoomId": 1,
            "memberId": 1,
            "role": "BOSS",
            "status": "APPROVED",
            "joinedAt": "2024-01-01T00:00:00",
            "memberName": "홍길동",
            "memberNickname": "길동이",
            "memberEmail": "user@example.com"
        }
    ]
}

8) 참가 신청 승인/거절
- URL: PUT /api/studies/{studyRoomId}/members/{memberId}/status?status=APPROVED
- 설명: 참가 신청 승인/거절 (방장만)
- Headers: Authorization: Bearer {JWT_TOKEN}
- Parameters: status (APPROVED, REJECTED)
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": null
}

9) 대기중인 멤버 조회
- URL: GET /api/studies/{studyRoomId}/pending-members
- 설명: 대기중인 멤버 목록 조회 (방장만)
- Headers: Authorization: Bearer {JWT_TOKEN}
- Response: 대기중인 멤버 목록

10) 스터디 탈퇴
- URL: DELETE /api/studies/{studyRoomId}/leave
- 설명: 스터디 탈퇴
- Headers: Authorization: Bearer {JWT_TOKEN}
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": null
}

15) 내가 참여한 스터디룸
- URL: GET /api/studies/my-studies
- 설명: 내가 참여한 스터디룸 목록
- Headers: Authorization: Bearer {JWT_TOKEN}
- Response: 참여한 스터디룸 목록

-------------------------------------------
1.4 메시지 관련 API (MessageController)
-------------------------------------------

1) 메시지 저장
- URL: POST /api/messages
- 설명: 새 메시지 저장 (Socket Server에서 호출)
- Request Body:
{
    "roomId": 1,
    "senderId": 1,
    "content": "안녕하세요!",
    "messageType": "TEXT"
}
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": {
        "messageId": 1,
        "roomId": 1,
        "senderId": 1,
        "content": "안녕하세요!",
        "messageType": "TEXT",
        "sentAt": "2024-01-01T00:00:00",
        "isDeleted": false,
        "senderNickname": "길동이",
        "senderName": "홍길동"
    }
}

2) 채팅 히스토리 조회 (이전 체팅 메시지)
- URL: GET /api/messages/history/{roomId}?page=1&size=50&beforeDate=2024-01-01T00:00:00
- 설명: 채팅 히스토리 조회 (페이징)
- Parameters: page, size, beforeDate (선택)
- Response: 메시지 목록

3) 채팅방별 메시지 조회 --------------------------- 보류
- URL: GET /api/messages/room/{roomId}
- 설명: 특정 채팅방의 모든 메시지 조회
- Response: 메시지 목록

4) 메시지 상세 조회 --------------------------- 보류
- URL: GET /api/messages/{messageId}
- 설명: 특정 메시지 조회
- Response: 메시지 상세 정보

5) 메시지 삭제 --------------------------- (관리자)
- URL: DELETE /api/messages/{messageId}
- 설명: 메시지 삭제 (논리 삭제)
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": null
}

6) 사용자별 메시지 조회 --------------------------- (관리자)
- URL: GET /api/messages/user/{senderId}
- 설명: 특정 사용자가 보낸 메시지 목록
- Response: 메시지 목록

7) 채팅방 메시지 개수 --------------------------- (관리자)
- URL: GET /api/messages/count/{roomId}
- 설명: 채팅방의 총 메시지 개수
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": 150
}

8) 최근 메시지 조회 --------------------------- (보류)
- URL: GET /api/messages/recent/{roomId}
- 설명: 최근 메시지 조회 (스크롤 업 시 사용)
- Response: 최근 20개 메시지

-------------------------------------------
1.5 파일 관련 API (FileController)
-------------------------------------------

1) 파일 업로드
- URL: POST /api/files/upload
- 설명: 파일 업로드
- Content-Type: multipart/form-data
- Form Data:
  - file: (MultipartFile)
  - studyRoomId: 1
  - uploaderId: 1
  - fileType: STUDY_ATTACHMENT (선택)
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": {
        "fileId": 1,
        "fileType": "STUDY_ATTACHMENT",
        "originalFilename": "document.pdf",
        "storedFilename": "20240101_123456_document.pdf",
        "filePath": "/uploads/study/1/",
        "fileSize": 1024000,
        "mimeType": "application/pdf",
        "uploadedAt": "2024-01-01T00:00:00"
    }
}

2) 파일 다운로드
- URL: GET /api/files/download/{fileId}
- 설명: 파일 다운로드
- Response: Binary file data

3) 파일 정보 조회 ------------------------ (5번으로 대체가능)
- URL: GET /api/files/info/{fileId}
- 설명: 파일 정보 조회
- Response: 파일 상세 정보

5) 스터디룸별 파일 목록
- URL: GET /api/files/studyroom/{studyRoomId}
- 설명: 특정 스터디룸의 파일 목록
- Response: 파일 목록

6) 회원별 파일 목록 ------------------------ (관리자)
- URL: GET /api/files/member/{memberId}
- 설명: 특정 회원이 업로드한 파일 목록
- Response: 파일 목록

7) 파일 삭제
- URL: DELETE /api/files/{fileId}
- 설명: 파일 삭제 (논리적 삭제)
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": null
}

-------------------------------------------
1.6 신고 관련 API (ReportController)
-------------------------------------------

1) 신고 생성
- URL: POST /api/reports
- 설명: 새 신고 생성
- Headers: Authorization: Bearer {JWT_TOKEN}
- Request Body:
{
    "reportedUserId": 2,
    "messageId": 1,
    "roomId": 1,  
    "studyRoomId": 1,
    "reason": "부적절한 언어 사용"
}
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": {
        "reportId": 1,
        "reporterId": 1,
        "reportedUserId": 2,
        "reportType": "USER",
        "reason": "부적절한 언어 사용",
        "status": "PENDING",
        "createdAt": "2024-01-01T00:00:00"
    }
}

2) 채팅 로그 신고
- URL: POST /api/reports/chat-log
- 설명: 채팅 로그 기반 신고
- Headers: Authorization: Bearer {JWT_TOKEN}
- Request Body:
{
    "reportedUserId": 2,
    "reportType": "MESSAGE",
    "messageId": 1,
    "roomId": 1,
    "reason": "욕설 사용",
    "logFileId": 1,
    "logMessageIndex": 50
}
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": null
}

-------------------------------------------
1.7 링크 미리보기 API (LinkPreviewController) 오지
-------------------------------------------

1) 링크 미리보기 추출
- URL: POST /api/link-preview/extract
- 설명: URL 메타데이터 추출
- Request Body:
{
    "url": "https://example.com"
}
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": {
        "url": "https://example.com",
        "title": "Example Website",
        "description": "This is an example website",
        "image": "https://example.com/image.jpg",
        "siteName": "Example"
    }
}

2) URL 추출 ------------------------ (링크)
- URL: POST /api/link-preview/extract-urls
- 설명: 텍스트에서 URL 추출
- Request Body: "텍스트 내용 https://example.com 포함"
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": ["https://example.com"]
}

3) URL 유효성 검사
- URL: POST /api/link-preview/validate
- 설명: URL 유효성 검사
- Request Body:
{
    "url": "https://example.com"
}
- Response:
{
    "success": true,
    "message": "SUCCESS",
    "data": true
}

=============================================
3. 공통 에러 응답 형식
=============================================

에러 발생 시 공통 응답 형식:
{
    "success": false,
    "message": "ERROR_CODE",
    "data": null,
    "timestamp": "2024-01-01T00:00:00"
}

주요 에러 코드:
- AUTH_ERROR: 인증 오류
- AUTH_REQUIRED: 인증 필요
- EMAIL_VERIFICATION_REQUIRED: 이메일 인증 필요
- LOGIN_FAILED: 로그인 실패
- REGISTRATION_ERROR: 회원가입 오류
- STUDY_CREATE_ERROR: 스터디 생성 오류
- MESSAGE_SAVE_ERROR: 메시지 저장 오류
- FILE_UPLOAD_ERROR: 파일 업로드 오류
- REPORT_CREATE_ERROR: 신고 생성 오류

=============================================
4. Postman 테스트 컬렉션 정보
=============================================

Postman에서 테스트할 때 사용할 환경 변수:
- {{baseUrl}}: http://localhost:7100
- {{token}}: JWT 토큰 (로그인 후 받은 토큰)

테스트 순서 권장사항:
1. 이메일 인증 → 회원가입 → 로그인
2. 스터디룸 생성 → 참가 → 채팅
3. 파일 업로드 → 다운로드
4. 신고 생성 → 관리자 처리

주요 Headers:
- Content-Type: application/json
- Authorization: Bearer {{token}}

=============================================
API 명세서 작성 완료
============================================= 
-->