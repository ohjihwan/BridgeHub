<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BridgeHub: 인터랙티브 API 탐색기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutral -->
    <!-- Application Structure Plan: The SPA is designed as an an interactive API explorer with a tab-based navigation for high-level resource grouping (DB 상세, ERD, Auth, Studies, etc.). This structure was chosen because API documentation is best consumed non-linearly. Developers can quickly jump to the specific resource they are interested in. The new ERD tab provides a high-level visual overview of the entire database structure, including cross-database relationships, before diving into detailed schema tables. Within other tabs, endpoints are presented in an accordion format, allowing users to view a high-level list and drill down into details (request/response, queries) without being overwhelmed. This layered approach enhances usability and discoverability for a technical audience. -->
    <!-- Visualization & Content Choices:
        - ERD: Report Info (MySQL/MongoDB relational diagram from text, including key indexes) -> Goal (Provide a clear, error-free visual understanding of database relationships and critical indexes) -> Presentation (Simplified Mermaid ER Diagram with PK/UK/FK indicators + detailed textual index list with explanations) -> Interaction (None needed for basic understanding) -> Justification (Mermaid diagrams are effective for visualizing database relationships and key indexes. A simplified version for the diagram itself combined with a detailed textual list of all indexes and their roles helps avoid rendering errors while providing comprehensive information.) -> Library (Mermaid JS).
        - DB 상세: Report Info (MySQL/MongoDB schemas, and their relationships) -> Goal (Organize and clarify data structures and their interconnections) -> Presentation (Styled HTML Tables + Textual Relationship Description) -> Interaction (None needed) -> Justification (Tables are the standard and most effective way to present structured schema data, supplemented by textual explanation of relationships for a comprehensive view) -> Method (HTML/Tailwind).
        - API Endpoints: Report Info (Endpoint details from specification) -> Goal (Inform and provide detailed technical specifications) -> Presentation (Accordion cards with styled code blocks) -> Interaction (Click to expand/collapse details) -> Justification (Accordions manage information density, allowing users to focus on one endpoint at a time) -> Method (HTML/Tailwind/JS).
        - Code/JSON Blocks: Report Info (JSON/SQL examples) -> Goal (Improve readability of technical code) -> Presentation (Syntax-highlighted code blocks) -> Interaction (None) -> Justification (Syntax highlighting is crucial for developer readability and error prevention) -> Method (JS-based simple regex highlighter).
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8f9fa;
            color: #343a40;
        }
        .tab-btn {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .tab-btn.active {
            border-bottom-color: #4f46e5;
            color: #4f46e5;
            font-weight: 700;
        }
        .accordion-header-icon {
            transition: transform 0.3s ease;
        }
        .accordion-content {
            transition: max-height 0.3s ease-in-out;
            max-height: 0;
            overflow: hidden;
        }
        .accordion-content.open {
            max-height: 2000px;
        }
        .api-method {
            font-size: 0.8rem;
            font-weight: 700;
            padding: 0.2rem 0.6rem;
            border-radius: 0.25rem;
            color: white;
        }
        .api-method-post { background-color: #48bb78; }
        .api-method-get { background-color: #4299e1; }
        .api-method-delete { background-color: #f56565; }
        pre code {
            font-family: 'D2Coding', 'Courier New', monospace;
            font-size: 0.875rem;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .json-key { color: #9b2c2c; }
        .json-string { color: #2c5282; }
        .json-number { color: #dd6b20; }
        .json-boolean { color: #b7791f; }
        .json-null { color: #718096; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #e2e8f0; padding: 12px; text-align: left; }
        th { background-color: #f7fafc; font-weight: 600; }
        td code { background-color: #edf2f7; padding: 2px 6px; border-radius: 4px; font-size: 0.85em; }
        .mermaid {
            overflow-x: auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 300px;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white shadow-sm sticky top-0 z-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <h1 class="text-3xl font-bold text-gray-800">BridgeHub: 인터랙티브 API 탐색기</h1>
            <p class="text-gray-500 mt-1">API 명세서를 시각적이고 체계적으로 탐색하세요.</p>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="bg-white p-6 rounded-lg shadow">
            <div class="border-b border-gray-200">
                <nav id="tabs" class="-mb-px flex space-x-6 overflow-x-auto">
                    <button data-tab="db-details" class="tab-btn active whitespace-nowrap py-4 px-1 text-sm font-medium">DB 상세</button>
                    <button data-tab="erd" class="tab-btn whitespace-nowrap py-4 px-1 text-sm font-medium">ERD</button>
                    <button data-tab="auth" class="tab-btn whitespace-nowrap py-4 px-1 text-sm font-medium">인증 API</button>
                    <button data-tab="studies" class="tab-btn whitespace-nowrap py-4 px-1 text-sm font-medium">스터디 API</button>
                    <button data-tab="messages" class="tab-btn whitespace-nowrap py-4 px-1 text-sm font-medium">메시지 API</button>
                    <button data-tab="files" class="tab-btn whitespace-nowrap py-4 px-1 text-sm font-medium">파일 API</button>
                    <button data-tab="logs" class="tab-btn whitespace-nowrap py-4 px-1 text-sm font-medium">채팅 로그 API</button>
                </nav>
            </div>

            <div id="tab-content" class="mt-6">
                
                <div id="db-details-content" class="tab-panel">
                    <h2 class="text-2xl font-bold mb-4">데이터베이스 스키마</h2>
                     <p class="mb-6 text-gray-600">
                        BridgeHub는 안정적인 데이터 관리를 위해 관계형 데이터베이스(MySQL)와 유연한 데이터 처리를 위한 NoSQL 데이터베이스(MongoDB)를 함께 사용합니다. 이 섹션에서는 각 데이터베이스에 정의된 테이블과 컬렉션의 상세 구조를 제공하여, 개발자가 데이터 모델을 이해하고 API와 상호작용하는 데 필요한 정보를 얻을 수 있도록 합니다.
                    </p>

                    <div class="mb-10">
                        <h3 class="text-xl font-bold mb-4 text-gray-700">전체 데이터베이스 구조 및 관계</h3>
                        <p class="mb-4 text-gray-600">
                            BridgeHub 시스템의 데이터는 MySQL과 MongoDB에 분산 저장되며, 상호 참조를 통해 통합적으로 관리됩니다.
                        </p>
                        <ul class="list-disc list-inside space-y-2 mb-6 text-gray-700">
                            <li><strong>MySQL:</strong> 사용자(<code>members</code>), 추가 회원 정보(<code>memberinfos</code>), 이메일 인증(<code>email_verifications</code>), 리프레시 토큰(<code>refresh_tokens</code>) 등 핵심 인증 및 사용자 정보를 관리합니다. 또한 스터디의 기본 정보(<code>studies</code>)와 스터디 멤버(<code>study_members</code>)도 MySQL에 저장됩니다.</li>
                            <li><strong>MongoDB:</strong> 스터디의 동적이고 가변적인 데이터(스터디 상세 정보 및 멤버 배열, 메시지, 파일 메타데이터, 채팅 로그, 세션)를 컬렉션 형태로 관리합니다.</li>
                            <li><strong>주요 관계:</strong>
                                <ul class="list-circle list-inside ml-5 space-y-1">
                                    <li>MySQL의 <code>members.id</code>는 모든 MongoDB 컬렉션(<code>Study</code>, <code>Message</code>, <code>ChatLog</code>, <code>File</code>, <code>Session</code>)에서 <code>memberId</code> 필드로 참조되어 사용자와 스터디 활동 간의 연동을 제공합니다.</li>
                                    <li>MySQL의 <code>studies.id</code>는 스터디 기본 정보를 저장하며, MongoDB의 <code>Study</code> 컬렉션과 개념적으로 연동됩니다. MongoDB의 <code>Study</code> 컬렉션의 <code>_id</code>는 <code>Message</code>, <code>ChatLog</code>, <code>File</code> 컬렉션의 <code>studyId</code> 필드에서 참조되어 해당 스터디에 속한 데이터를 연결합니다.</li>
                                    <li><code>Study</code> 컬렉션 내의 <code>members</code> 배열은 MySQL <code>members.id</code>를 포함하여 스터디에 참여한 멤버 정보를 동적으로 관리합니다.</li>
                                    <li><code>Message</code> 및 <code>File</code> 컬렉션의 <code>_id</code>는 <code>ChatLog</code> 컬렉션의 <code>metadata</code> 필드를 통해 활동 로그와 연결됩니다.</li>
                                    <li><code>Session</code> 컬렉션은 MySQL의 <code>members.id</code>를 참조하여 사용자의 로그인 세션을 추적합니다.</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="mb-10">
                        <h3 class="text-xl font-bold mb-4 text-indigo-700">MySQL 스키마</h3>
                        <div class="space-y-6">
                            <div>
                                <h4 class="font-bold text-lg mb-2">members</h4>
                                <table><thead><tr><th>컬럼</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>id</td><td><code>INT</code></td><td>고유 회원 ID (PK)</td></tr>
                                    <tr><td>userid</td><td><code>VARCHAR(100)</code></td><td>이메일 형식의 사용자 ID (UNIQUE)</td></tr>
                                    <tr><td>name</td><td><code>VARCHAR(50)</code></td><td>사용자 실명</td></tr>
                                    <tr><td>password</td><td><code>VARCHAR(255)</code></td><td>암호화된 비밀번호</td></tr>
                                    <tr><td>phone</td><td><code>VARCHAR(20)</code></td><td>전화번호</td></tr>
                                    <tr><td>gender</td><td><code>ENUM</code></td><td>성별 ('남자', '여자')</td></tr>
                                    <tr><td>education</td><td><code>ENUM</code></td><td>학력 ('고졸','대학교','대학원')</td></tr>
                                    <tr><td>nickname</td><td><code>VARCHAR(50)</code></td><td>닉네임</td></tr>
                                    <tr><td>created_at</td><td><code>TIMESTAMP</code></td><td>생성 일시</td></tr>
                                    <tr><td>updated_at</td><td><code>TIMESTAMP</code></td><td>최종 업데이트 일시</td></tr>
                                </tbody></table>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">memberinfos</h4>
                                <table><thead><tr><th>컬럼</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>member_id</td><td><code>INT</code></td><td>members.id와 1:1 매핑 (PK, FK)</td></tr>
                                    <tr><td>major</td><td><code>VARCHAR(50)</code></td><td>전공</td></tr>
                                    <tr><td>area</td><td><code>VARCHAR(50)</code></td><td>활동 지역</td></tr>
                                    <tr><td>timezone</td><td><code>VARCHAR(50)</code></td><td>타임존</td></tr>
                                    <tr><td>created_at</td><td><code>TIMESTAMP</code></td><td>생성 일시</td></tr>
                                    <tr><td>updated_at</td><td><code>TIMESTAMP</code></td><td>최종 업데이트 일시</td></tr>
                                </tbody></table>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">email_verifications</h4>
                                <table><thead><tr><th>컬럼</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>id</td><td><code>INT</code></td><td>고유 ID (PK)</td></tr>
                                    <tr><td>email</td><td><code>VARCHAR(100)</code></td><td>인증 요청 이메일 (UNIQUE)</td></tr>
                                    <tr><td>verification_code</td><td><code>VARCHAR(6)</code></td><td>인증 코드</td></tr>
                                    <tr><td>is_verified</td><td><code>BOOLEAN</code></td><td>인증 여부</td></tr>
                                    <tr><td>created_at</td><td><code>TIMESTAMP</code></td><td>생성 일시</td></tr>
                                    <tr><td>expires_at</td><td><code>TIMESTAMP</code></td><td>만료 일시</td></tr>
                                </tbody></table>
                            </div>
                             <div>
                                <h4 class="font-bold text-lg mb-2">refresh_tokens</h4>
                                <table><thead><tr><th>컬럼</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>id</td><td><code>INT</code></td><td>고유 ID (PK)</td></tr>
                                    <tr><td>member_id</td><td><code>INT</code></td><td>회원 ID (FK)</td></tr>
                                    <tr><td>token</td><td><code>VARCHAR(255)</code></td><td>리프레시 토큰 (UNIQUE)</td></tr>
                                    <tr><td>created_at</td><td><code>TIMESTAMP</code></td><td>생성 일시</td></tr>
                                    <tr><td>expires_at</td><td><code>TIMESTAMP</code></td><td>만료 일시</td></tr>
                                </tbody></table>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">studies</h4>
                                <table><thead><tr><th>컬럼</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>id</td><td><code>INT</code></td><td>고유 스터디 ID (PK)</td></tr>
                                    <tr><td>title</td><td><code>VARCHAR(200)</code></td><td>스터디 제목</td></tr>
                                    <tr><td>description</td><td><code>TEXT</code></td><td>스터디 설명</td></tr>
                                    <tr><td>max_members</td><td><code>INT</code></td><td>최대 참여 멤버 수</td></tr>
                                    <tr><td>created_by</td><td><code>INT</code></td><td>생성자 ID (FK)</td></tr>
                                    <tr><td>created_at</td><td><code>TIMESTAMP</code></td><td>생성 일시</td></tr>
                                    <tr><td>updated_at</td><td><code>TIMESTAMP</code></td><td>최종 업데이트 일시</td></tr>
                                </tbody></table>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">study_members</h4>
                                <table><thead><tr><th>컬럼</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>id</td><td><code>INT</code></td><td>고유 ID (PK)</td></tr>
                                    <tr><td>study_id</td><td><code>INT</code></td><td>스터디 ID (FK)</td></tr>
                                    <tr><td>member_id</td><td><code>INT</code></td><td>회원 ID (FK)</td></tr>
                                    <tr><td>role</td><td><code>ENUM</code></td><td>스터디 내 역할 ('LEADER', 'MEMBER')</td></tr>
                                    <tr><td>joined_at</td><td><code>TIMESTAMP</code></td><td>스터디 참여 일시</td></tr>
                                </tbody></table>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">messages</h4>
                                <table><thead><tr><th>컬럼</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>id</td><td><code>INT</code></td><td>고유 메시지 ID (PK)</td></tr>
                                    <tr><td>study_id</td><td><code>INT</code></td><td>스터디 ID (FK)</td></tr>
                                    <tr><td>member_id</td><td><code>INT</code></td><td>발신자 ID (FK)</td></tr>
                                    <tr><td>content</td><td><code>TEXT</code></td><td>메시지 내용</td></tr>
                                    <tr><td>created_at</td><td><code>TIMESTAMP</code></td><td>메시지 전송 일시</td></tr>
                                </tbody></table>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">files</h4>
                                <table><thead><tr><th>컬럼</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>id</td><td><code>INT</code></td><td>고유 파일 ID (PK)</td></tr>
                                    <tr><td>study_id</td><td><code>INT</code></td><td>스터디 ID (FK)</td></tr>
                                    <tr><td>member_id</td><td><code>INT</code></td><td>업로더 ID (FK)</td></tr>
                                    <tr><td>filename</td><td><code>VARCHAR(255)</code></td><td>서버 저장 파일명</td></tr>
                                    <tr><td>original_name</td><td><code>VARCHAR(255)</code></td><td>원본 파일명</td></tr>
                                    <tr><td>file_path</td><td><code>VARCHAR(500)</code></td><td>파일 저장 경로</td></tr>
                                    <tr><td>file_size</td><td><code>INT</code></td><td>파일 크기</td></tr>
                                    <tr><td>mime_type</td><td><code>VARCHAR(100)</code></td><td>파일 MIME 타입</td></tr>
                                    <tr><td>uploaded_at</td><td><code>TIMESTAMP</code></td><td>파일 업로드 일시</td></tr>
                                </tbody></table>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold mb-4 text-green-700">MongoDB 컬렉션 상세</h3>
                        <p class="mb-4 text-gray-600">
                            MongoDB는 유연한 스키마를 활용하여 스터디의 동적인 상태와 관련된 데이터를 저장합니다. 각 컬렉션의 상세 필드 정보와 역할은 다음과 같습니다.
                        </p>
                        <div class="space-y-6">
                             <div>
                                <h4 class="font-bold text-lg mb-2">Study</h4>
                                <table><thead><tr><th>필드</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>_id</td><td><code>ObjectId</code></td><td>고유 스터디 ID (PK)</td></tr>
                                    <tr><td>title</td><td><code>String</code></td><td>스터디 제목</td></tr>
                                    <tr><td>description</td><td><code>String</code></td><td>스터디 설명</td></tr>
                                    <tr><td>maxMembers</td><td><code>Number</code></td><td>최대 참여 멤버 수</td></tr>
                                    <tr><td>createdBy</td><td><code>Number</code></td><td>생성자 ID (MySQL members.id 참조)</td></tr>
                                    <tr><td>members</td><td><code>Array</code></td><td>참여 멤버 목록 (서브도큐먼트: memberId, role, joinedAt, lastActive, isOnline)</td></tr>
                                    <tr><td>settings</td><td><code>Object</code></td><td>스터디 설정 (isPublic, allowFileSharing, maxFileSize)</td></tr>
                                    <tr><td>status</td><td><code>Object</code></td><td>스터디 상태 (isActive, lastActivity)</td></tr>
                                    <tr><td>createdAt</td><td><code>Date</code></td><td>스터디 생성 일시</td></tr>
                                    <tr><td>updatedAt</td><td><code>Date</code></td><td>최종 업데이트 일시</td></tr>
                                </tbody></table>
                            </div>
                             <div>
                                <h4 class="font-bold text-lg mb-2">Message</h4>
                                <table><thead><tr><th>필드</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>_id</td><td><code>ObjectId</code></td><td>고유 메시지 ID (PK)</td></tr>
                                    <tr><td>studyId</td><td><code>ObjectId</code></td><td>스터디 ID (FK, Study 참조)</td></tr>
                                    <tr><td>memberId</td><td><code>Number</code></td><td>발신자 ID (MySQL members.id 참조)</td></tr>
                                    <tr><td>content</td><td><code>String</code></td><td>메시지 내용</td></tr>
                                    <tr><td>type</td><td><code>String</code></td><td>메시지 타입 ('TEXT', 'FILE', 'SYSTEM')</td></tr>
                                    <tr><td>metadata</td><td><code>Object</code></td><td>메시지 관련 추가 메타데이터 (fileInfo 등)</td></tr>
                                    <tr><td>createdAt</td><td><code>Date</code></td><td>메시지 전송 일시</td></tr>
                                </tbody></table>
                            </div>
                             <div>
                                <h4 class="font-bold text-lg mb-2">ChatLog</h4>
                                <table><thead><tr><th>필드</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>_id</td><td><code>ObjectId</code></td><td>고유 로그 ID (PK)</td></tr>
                                    <tr><td>studyId</td><td><code>ObjectId</code></td><td>스터디 ID (FK, Study 참조)</td></tr>
                                    <tr><td>memberId</td><td><code>Number</code></td><td>활동 수행자 ID (MySQL members.id 참조)</td></tr>
                                    <tr><td>action</td><td><code>String</code></td><td>활동 타입 ('JOIN', 'LEAVE', 'LOGIN', 'LOGOUT', 'MESSAGE', 'FILE_SHARE')</td></tr>
                                    <tr><td>content</td><td><code>String</code></td><td>활동 설명</td></tr>
                                    <tr><td>metadata</td><td><code>Object</code></td><td>활동에 대한 추가 메타데이터 (messageId, fileId, previousState)</td></tr>
                                    <tr><td>timestamp</td><td><code>Date</code></td><td>로그 생성 일시</td></tr>
                                </tbody></table>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">File</h4>
                                <table><thead><tr><th>필드</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>_id</td><td><code>ObjectId</code></td><td>고유 파일 ID (PK)</td></tr>
                                    <tr><td>studyId</td><td><code>ObjectId</code></td><td>스터디 ID (FK, Study 참조)</td></tr>
                                    <tr><td>memberId</td><td><code>Number</code></td><td>업로더 ID (MySQL members.id 참조)</td></tr>
                                    <tr><td>filename</td><td><code>String</code></td><td>서버 저장 파일명</td></tr>
                                    <tr><td>originalName</td><td><code>String</code></td><td>원본 파일명</td></tr>
                                    <tr><td>filePath</td><td><code>String</code></td><td>파일 저장 경로</td></tr>
                                    <tr><td>fileSize</td><td><code>Number</code></td><td>파일 크기</td></tr>
                                    <tr><td>mimeType</td><td><code>String</code></td><td>파일 MIME 타입</td></tr>
                                    <tr><td>metadata</td><td><code>Object</code></td><td>파일 관련 추가 메타데이터 (width, height, duration, thumbnail)</td></tr>
                                    <tr><td>uploadedAt</td><td><code>Date</code></td><td>파일 업로드 일시</td></tr>
                                </tbody></table>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">Session</h4>
                                <table><thead><tr><th>필드</th><th>타입</th><th>설명</th></tr></thead><tbody>
                                    <tr><td>_id</td><td><code>ObjectId</code></td><td>고유 세션 ID (PK)</td></tr>
                                    <tr><td>memberId</td><td><code>Number</code></td><td>회원 ID (MySQL members.id 참조)</td></tr>
                                    <tr><td>token</td><td><code>String</code></td><td>세션 토큰 (UNIQUE)</td></tr>
                                    <tr><td>deviceInfo</td><td><code>Object</code></td><td>접속 장치 정보 (userAgent, ip, lastAccess)</td></tr>
                                    <tr><td>expiresAt</td><td><code>Date</code></td><td>세션 만료 일시 (TTL 인덱스 적용)</td></tr>
                                    <tr><td>createdAt</td><td><code>Date</code></td><td>세션 생성 일시</td></tr>
                                </tbody></table>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="erd-content" class="tab-panel hidden">
                    <h2 class="text-2xl font-bold mb-4">ERD (엔티티-관계 다이어그램)</h2>
                    <p class="mb-6 text-gray-600">
                        BridgeHub 시스템의 MySQL 테이블과 MongoDB 컬렉션 간의 전체적인 데이터 관계를 시각적으로 보여주는 다이어그램입니다.
                        <br>
                        <strong>참고:</strong> MySQL과 MongoDB는 다른 데이터베이스 시스템이므로, 직접적인 외래 키 관계보다는 개념적인 연결을 나타냅니다. MySQL의 <code>members.id</code>는 MongoDB 컬렉션의 <code>memberId</code> 필드에서, MongoDB <code>Study</code> 컬렉션의 <code>_id</code>는 다른 MongoDB 컬렉션의 <code>studyId</code> 필드에서 참조됩니다.
                    </p>
                    <div class="mermaid">
erDiagram
    subgraph "MySQL Table"
        direction LR
        members {
            INT id PK
            VARCHAR userid UK
        }
        memberinfos {
            INT member_id PK,FK
        }
        email_verifications {
            INT id PK
            VARCHAR email UK
        }
        refresh_tokens {
            INT id PK
            INT member_id FK
            VARCHAR token UK
        }
        studies {
            INT id PK
            VARCHAR title
            INT created_by FK
        }
        study_members {
            INT id PK
            INT study_id FK
            INT member_id FK
        }
        mysql_messages ["messages (MySQL)"] {
            INT id PK
            INT study_id FK
            INT member_id FK
        }
        mysql_files ["files (MySQL)"] {
            INT id PK
            INT study_id FK
            INT member_id FK
        }
    end

    subgraph "MongoDB Collection"
        direction LR
        Mongo_Study ["Study (Mongo)"] {
            ObjectId _id PK
            Number createdBy
        }
        Mongo_Message ["Message (Mongo)"] {
            ObjectId _id PK
            ObjectId studyId
            Number memberId
        }
        Mongo_ChatLog ["ChatLog (Mongo)"] {
            ObjectId _id PK
            ObjectId studyId
            Number memberId
        }
        Mongo_File ["File (Mongo)"] {
            ObjectId _id PK
            ObjectId studyId
            Number memberId
        }
        Mongo_Session ["Session (Mongo)"] {
            ObjectId _id PK
            Number memberId
            String token UK
        }
    end
    
    %% MySQL Internal Relations
    members ||--|{ memberinfos : "1:1 매핑"
    members ||--o{ refresh_tokens : "N개 토큰 소유"
    members ||--o{ studies : "N개 스터디 생성"
    members ||--o{ study_members : "N개 스터디 참여"
    studies ||--o{ study_members : "N명 멤버 포함"
    members ||--o{ mysql_messages : "N개 메시지 작성"
    studies ||--o{ mysql_messages : "N개 메시지 포함"
    members ||--o{ mysql_files : "N개 파일 업로드"
    studies ||--o{ mysql_files : "N개 파일 포함"

    %% MongoDB Internal Relations
    Mongo_Study ||--o{ Mongo_Message : "N개 메시지 포함"
    Mongo_Study ||--o{ Mongo_ChatLog : "N개 로그 포함"
    Mongo_Study ||--o{ Mongo_File : "N개 파일 포함"

    %% Cross-DB Conceptual Relations
    members }o..o{ Mongo_Study : "createdBy 참조"
    members }o..o{ Mongo_Message : "memberId 참조"
    members }o..o{ Mongo_ChatLog : "memberId 참조"
    members }o..o{ Mongo_File : "memberId 참조"
    members }o..o{ Mongo_Session : "memberId 참조"
                    </div>

                    <div class="mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h3 class="text-xl font-bold mb-4 text-gray-800">인덱스 상세 정보</h3>
                        <p class="mb-4 text-gray-600">성능 최적화 및 데이터 무결성 유지를 위해 데이터베이스에 정의된 인덱스 목록과 그 역할입니다.</p>

                        <div class="mb-6">
                            <h4 class="font-bold text-lg mb-2 text-indigo-700">MySQL 인덱스</h4>
                            <ul class="list-disc list-inside space-y-2 text-gray-700">
                                <li><code>members(userid)</code>: **UNIQUE KEY** - 사용자 로그인 시 이메일로 회원을 빠르게 찾고, 이메일 중복을 방지하여 데이터 무결성을 보장합니다.</li>
                                <li><code>email_verifications(email)</code>: **UNIQUE KEY** - 이메일 인증 시 특정 이메일에 대한 인증 코드를 빠르게 조회하며, 동일 이메일에 대한 인증 코드 중복 생성을 방지합니다.</li>
                                <li><code>refresh_tokens(token)</code>: **UNIQUE KEY** - 리프레시 토큰을 이용한 세션 유효성 검사 시 토큰을 빠르게 조회하고, 토큰 값의 중복을 방지합니다.</li>
                                <li><code>study_members(member_id)</code>: `idx_study_members_member_id` - 특정 회원이 참여한 스터디 목록을 빠르게 조회할 때 사용됩니다.</li>
                                <li><code>study_members(study_id)</code>: `idx_study_members_study_id` - 특정 스터디에 참여한 멤버 목록을 빠르게 조회할 때 사용됩니다.</li>
                                <li><code>messages(study_id)</code>: `idx_messages_study_id` - 특정 스터디의 메시지를 효율적으로 조회하기 위한 인덱스입니다.</li>
                                <li><code>messages(member_id)</code>: `idx_messages_member_id` - 특정 회원이 작성한 메시지 목록을 조회할 때 성능을 향상시킵니다.</li>
                                <li><code>files(study_id)</code>: `idx_files_study_id` - 특정 스터디에 업로드된 파일 목록을 빠르게 조회하기 위한 인덱스입니다.</li>
                                <li><code>files(member_id)</code>: `idx_files_member_id` - 특정 회원이 업로드한 파일 목록을 조회할 때 성능을 향상시킵니다.</li>
                            </ul>
                        </div>

                        <div>
                            <h4 class="font-bold text-lg mb-2 text-green-700">MongoDB 인덱스</h4>
                            <ul class="list-disc list-inside space-y-2 text-gray-700">
                                <li><code>Study({title: 'text', description: 'text'})</code>: **텍스트 검색 인덱스** - 스터디 제목 또는 설명 내용으로 스터디를 검색할 때 전문 검색 기능을 제공하여 관련 스터디를 빠르게 찾을 수 있도록 돕습니다.</li>
                                <li><code>Study({'members.memberId': 1})</code>: 특정 멤버가 참여한 스터디를 조회할 때 (예: '내 스터디' 목록) 해당 필드를 기준으로 쿼리 성능을 최적화합니다.</li>
                                <li><code>Study({'status.isActive': 1, 'status.lastActivity': -1})</code>: 활성화된 스터디 중 최근 활동이 있는 스터디를 우선적으로 보여줄 때, 활성 상태와 최신 활동 시간 순으로 정렬하여 조회 성능을 높입니다.</li>
                                <li><code>Message({studyId: 1, createdAt: -1})</code>: 특정 스터디 채팅방의 메시지를 최신순으로 가져올 때 `studyId`로 효율적인 필터링을, `createdAt`으로 빠른 정렬을 제공합니다.</li>
                                <li><code>Message({memberId: 1})</code>: 특정 회원이 보낸 메시지를 조회할 때 사용되어, 해당 회원의 메시지 기록을 빠르게 찾을 수 있도록 합니다.</li>
                                <li><code>ChatLog({studyId: 1, timestamp: -1})</code>: 특정 스터디의 활동 로그를 최신순으로 조회할 때 `studyId`를 기준으로 필터링하고 `timestamp`를 기준으로 정렬하여 효율성을 높입니다.</li>
                                <li><code>ChatLog({memberId: 1, studyId: 1})</code>: 특정 멤버가 특정 스터디에서 수행한 활동 로그를 조회할 때 사용되며, 두 필드를 복합적으로 활용하여 정확하고 빠른 검색을 가능하게 합니다.</li>
                                <li><code>File({studyId: 1, uploadedAt: -1})</code>: 특정 스터디에 업로드된 파일 목록을 최신 업로드 순으로 조회할 때 성능을 최적화합니다.</li>
                                <li><code>File({memberId: 1})</code>: 특정 회원이 업로드한 파일 목록을 조회할 때 사용되어, 해당 회원의 파일 기록을 빠르게 찾을 수 있도록 합니다.</li>
                                <li><code>Session({token: 1})</code>: **UNIQUE** - 세션 토큰으로 유효한 세션 정보를 빠르게 찾아내어 인증 및 권한 확인 절차를 가속화합니다. 토큰의 중복을 방지합니다.</li>
                                <li><code>Session({memberId: 1})</code>: 특정 회원의 현재 활성화된 세션을 관리하거나 조회할 때 사용됩니다.</li>
                                <li><code>Session({expiresAt: 1})</code>: **TTL 인덱스** - 세션의 `expiresAt` 필드를 기준으로 자동으로 오래된 세션 데이터를 삭제하여, 데이터베이스의 불필요한 데이터를 관리하고 공간을 효율적으로 사용합니다.</li>
                            </ul>
                        </div>
                    </div>
                </div>


                <div id="auth-content" class="tab-panel hidden">
                    <h2 class="text-2xl font-bold mb-4">인증 API (`/auth`)</h2>
                    <p class="mb-6 text-gray-600">이 섹션은 사용자 인증과 관련된 모든 엔드포인트를 다룹니다. 회원가입, 로그인, 이메일 인증, 프로필 조회 등 사용자 계정의 라이프사이클을 관리하는 기능을 제공합니다.</p>
                    <div class="space-y-4 accordion-container"></div>
                </div>

                <div id="studies-content" class="tab-panel hidden">
                    <h2 class="text-2xl font-bold mb-4">스터디 API (`/studies`)</h2>
                    <p class="mb-6 text-gray-600">스터디의 생성, 목록 및 상세 정보 조회, 참여 및 탈퇴 등 스터디 그룹 관리에 필요한 핵심 기능들을 제공하는 엔드포인트 목록입니다.</p>
                    <div class="space-y-4 accordion-container"></div>
                </div>

                <div id="messages-content" class="tab-panel hidden">
                    <h2 class="text-2xl font-bold mb-4">메시지 API (`/studies/:studyId/messages`)</h2>
                    <p class="mb-6 text-gray-600">스터디 내에서 멤버 간의 커뮤니케이션을 담당하는 메시지 전송 및 조회 기능을 제공합니다.</p>
                    <div class="space-y-4 accordion-container"></div>
                </div>

                <div id="files-content" class="tab-panel hidden">
                    <h2 class="text-2xl font-bold mb-4">파일 API (`/studies/:studyId/files`)</h2>
                    <p class="mb-6 text-gray-600">스터디 내에서 파일을 공유하고 관리하기 위한 엔드포인트입니다. 파일 업로드, 목록 조회, 다운로드, 삭제 기능을 포함합니다.</p>
                    <div class="space-y-4 accordion-container"></div>
                </div>

                <div id="logs-content" class="tab-panel hidden">
                    <h2 class="text-2xl font-bold mb-4">채팅 로그 API (`/studies/:studyId/logs`)</h2>
                    <p class="mb-6 text-gray-600">스터디 내에서 발생하는 모든 주요 활동(참여, 메시징, 파일 공유 등)을 기록하고 조회하는 기능을 제공합니다.</p>
                    <div class="space-y-4 accordion-container"></div>
                </div>

            </div>
        </div>
    </main>
    
<script>
document.addEventListener('DOMContentLoaded', () => {
    mermaid.initialize({ startOnLoad: false });

    const apiData = {
        auth: [
            {
                title: '회원가입',
                method: 'POST',
                endpoint: '/auth/signup',
                description: '새로운 사용자를 등록합니다. 기본 정보와 함께 스터디 매칭에 사용될 추가 정보를 함께 받아 처리합니다.',
                request: `{
    "userid": "user@example.com",
    "password": "password123",
    "name": "홍길동",
    "phone": "010-1234-5678",
    "gender": "남자",
    "education": "대학교",
    "nickname": "gildong",
    "major": "Computer Science",
    "area": "Seoul",
    "timezone": "Asia/Seoul"
}`,
                response: `{
    "success": true,
    "message": "회원가입이 완료되었습니다.",
    "data": {
        "token": "jwt.token.string",
        "user": {
            "id": 1,
            "userid": "user@example.com",
            "name": "홍길동",
            "nickname": "gildong"
        }
    }
}`,
                query: `// MySQL
INSERT INTO members (userid, password, name, ...) VALUES (?, ?, ?, ...);
INSERT INTO memberinfos (member_id, major, area, ...) VALUES (LAST_INSERT_ID(), ?, ?, ...);`
            },
            {
                title: '로그인',
                method: 'POST',
                endpoint: '/auth/login',
                description: '사용자 ID(이메일)와 비밀번호로 로그인하여 Access Token과 Refresh Token을 발급받습니다.',
                request: `{
    "userid": "user@example.com",
    "password": "password123"
}`,
                response: `{
    "success": true,
    "data": {
        "accessToken": "access.jwt.token",
        "refreshToken": "refresh.jwt.token",
        "user": {
            "id": 1,
            "userid": "user@example.com",
            "name": "홍길동",
            "nickname": "gildong"
        }
    }
}`,
                query: `// MySQL
SELECT id, userid, password, ... FROM members WHERE userid = ?;
INSERT INTO refresh_tokens (member_id, token, expires_at) VALUES (?, ?, ?);

// MongoDB
const session = new Session({ ... });
await session.save();`
            },
            {
                title: '이메일 인증 코드 전송',
                method: 'POST',
                endpoint: '/auth/send-verification',
                description: '회원가입을 위한 이메일 주소 인증 코드를 발송합니다.',
                request: `{"email": "verify@example.com"}`,
                response: `{"success": true, "message": "인증 이메일이 전송되었습니다."}`,
                query: `// MySQL
DELETE FROM email_verifications WHERE email = ?;
INSERT INTO email_verifications (email, verification_code, expires_at) VALUES (?, ?, ?);`
            },
            {
                title: '인증 코드 확인',
                method: 'POST',
                endpoint: '/auth/verify-code',
                description: '전송된 이메일 인증 코드가 유효한지 확인합니다.',
                request: `{
    "email": "verify@example.com",
    "code": "123456"
}`,
                response: `{"success": true, "message": "인증이 완료되었습니다."}`,
                query: `// MySQL
SELECT id, is_verified FROM email_verifications WHERE email = ? AND verification_code = ? AND expires_at > NOW();`
            },
            {
                title: '프로필 조회',
                method: 'GET',
                endpoint: '/auth/profile',
                description: '현재 로그인된 사용자의 전체 프로필 정보를 조회합니다.',
                request: `// Headers
Authorization: Bearer <accessToken>`,
                response: `{
    "success": true,
    "data": {
        "user": {
            "id": 1,
            "userid": "user@example.com",
            "name": "홍길동",
            "major": "Computer Science",
            "area": "Seoul"
        }
    }
}`,
                query: `// MySQL
SELECT m.*, mi.major, mi.area, mi.timezone FROM members m LEFT JOIN memberinfos mi ON m.id = mi.member_id WHERE m.id = ?;`
            }
        ],
        studies: [
            {
                title: '스터디 생성',
                method: 'POST',
                endpoint: '/studies',
                description: '새로운 스터디 그룹을 생성합니다. 생성자가 자동으로 리더가 됩니다.',
                request: `{
    "title": "리액트 스터디",
    "description": "리액트 기초부터 심화까지 함께 공부해요.",
    "maxMembers": 10,
    "settings": { "isPublic": true }
}`,
                response: `{
    "success": true,
    "data": {
        "study": {
            "id": "60d...a1",
            "title": "리액트 스터디",
            "createdBy": 1,
            "members": [{"memberId": 1, "role": "LEADER"}]
        }
    }
}`,
                query: `// MongoDB
const study = new Study({ ... });
await study.save();
const chatLog = new ChatLog({ action: 'JOIN', ... });
await chatLog.save();`
            },
            {
                title: '스터디 목록 조회',
                method: 'GET',
                endpoint: '/studies?page=1&limit=10&search=리액트',
                description: '활성화된 공개 스터디 목록을 검색 및 페이지네이션하여 조회합니다.',
                request: `// Headers
Authorization: Bearer <accessToken>`,
                response: `{
    "success": true,
    "data": {
        "studies": [{
            "id": "60d...a1",
            "title": "리액트 스터디",
            "memberCount": 5,
            "lastActivity": "2025-06-16T12:00:00.000Z"
        }],
        "pagination": { "total": 1, "page": 1, "limit": 10 }
    }
}`,
                query: `// MongoDB
const studies = await Study.find({ 'status.isActive': true, title: /리액트/ })
    .sort({ 'status.lastActivity': -1 })
    .skip(...)
    .limit(...);`
            },
            {
                title: '스터디 상세 조회',
                method: 'GET',
                endpoint: '/studies/:studyId',
                description: '특정 스터디의 상세 정보를 조회합니다. 멤버 목록, 설정 등을 포함합니다.',
                 request: `// Headers
Authorization: Bearer <accessToken>`,
                response: `{
    "success": true,
    "data": {
        "study": {
            "id": "60d...a1",
            "title": "리액트 스터디",
            "members": [
                {"memberId": 1, "role": "LEADER", "isOnline": true},
                {"memberId": 2, "role": "MEMBER", "isOnline": false}
            ],
            "settings": { "isPublic": true }
        }
    }
}`,
                query: `// MongoDB
const study = await Study.findById(studyId);`
            },
            {
                title: '스터디 참여',
                method: 'POST',
                endpoint: '/studies/:studyId/join',
                description: '특정 스터디에 멤버로 참여합니다.',
                 request: `// Headers
Authorization: Bearer <accessToken>`,
                response: `{
    "success": true,
    "message": "스터디 참여에 성공했습니다."
}`,
                query: `// MongoDB
const study = await Study.findById(studyId);
study.members.push({ memberId: req.user.id, role: 'MEMBER' });
await study.save();`
            },
            {
                title: '스터디 퇴장',
                method: 'POST',
                endpoint: '/studies/:studyId/leave',
                description: '참여 중인 스터디에서 퇴장합니다.',
                 request: `// Headers
Authorization: Bearer <accessToken>`,
                response: `{"success": true, "message": "스터디 퇴장이 완료되었습니다."}`,
                query: `// MongoDB
const study = await Study.findByIdAndUpdate(studyId, { $pull: { members: { memberId: req.user.id } } });`
            }
        ],
        messages: [
            {
                title: '메시지 전송',
                method: 'POST',
                endpoint: '/studies/:studyId/messages',
                description: '스터디 채팅방에 텍스트 메시지를 전송합니다.',
                request: `{
    "content": "안녕하세요! 반갑습니다.",
    "type": "TEXT"
}`,
                response: `{
    "success": true,
    "data": {
        "message": {
            "id": "60d...b2",
            "studyId": "60d...a1",
            "memberId": 1,
            "content": "안녕하세요! 반갑습니다."
        }
    }
}`,
                query: `// MongoDB
const message = new Message({ ... });
await message.save();
await Study.findByIdAndUpdate(studyId, { 'status.lastActivity': new Date() });`
            },
            {
                title: '메시지 목록 조회',
                method: 'GET',
                endpoint: '/studies/:studyId/messages?limit=50',
                description: '스터디 채팅방의 메시지 목록을 시간 역순으로 조회합니다. (무한 스크롤)',
                request: `// Headers
Authorization: Bearer <accessToken>`,
                response: `{
    "success": true,
    "data": {
        "messages": [
            { "id": "60d...b2", "content": "안녕하세요! 반갑습니다." },
            { "id": "60d...b1", "content": "채팅방이 개설되었습니다." }
        ],
        "hasMore": true
    }
}`,
                query: `// MongoDB
const messages = await Message.find({ studyId })
    .sort({ createdAt: -1 })
    .limit(50);`
            }
        ],
        files: [
            {
                title: '파일 업로드',
                method: 'POST',
                endpoint: '/studies/:studyId/files',
                description: '스터디에 파일을 업로드합니다. 요청은 multipart/form-data 형식입니다.',
                request: `// Request Type: multipart/form-data
// Field: "file" -> (binary file data)`,
                response: `{
    "success": true,
    "data": {
        "file": {
            "id": "60d...c3",
            "filename": "server_filename.png",
            "originalName": "my_screenshot.png",
            "fileSize": 102400,
            "mimeType": "image/png"
        }
    }
}`,
                query: `// MongoDB
const file = new File({ ... });
await file.save();`
            },
            {
                title: '파일 목록 조회',
                method: 'GET',
                endpoint: '/studies/:studyId/files',
                description: '스터디에 업로드된 파일 목록을 조회합니다.',
                request: `// Headers
Authorization: Bearer <accessToken>`,
                response: `{
    "success": true,
    "data": { "files": [ /* file objects */ ] }
}`,
                query: `// MongoDB
const files = await File.find({ studyId }).sort({ uploadedAt: -1 });`
            },
            {
                title: '파일 다운로드',
                method: 'GET',
                endpoint: '/studies/:studyId/files/:filename/download',
                description: '서버에 저장된 파일을 다운로드합니다.',
                request: `// Headers
Authorization: Bearer <accessToken>`,
                response: `(File Stream)`,
                query: `// MongoDB
const file = await File.findOne({ studyId, filename });`
            },
            {
                title: '파일 삭제',
                method: 'DELETE',
                endpoint: '/studies/:studyId/files/:filename',
                description: '스터디에 업로드된 파일을 삭제합니다.',
                request: `// Headers
Authorization: Bearer <accessToken>`,
                response: `{"success": true, "message": "파일이 삭제되었습니다."}`,
                query: `// MongoDB
const file = await File.findOneAndDelete({ studyId, filename });`
            }
        ],
        logs: [
            {
                title: '채팅 로그 조회',
                method: 'GET',
                endpoint: '/studies/:studyId/logs',
                description: '스터디 내의 활동 로그(참여, 퇴장, 메시지 등)를 조회합니다.',
                request: `// Headers
Authorization: Bearer <accessToken>`,
                response: `{
    "success": true,
    "data": {
        "logs": [
            { "action": "MESSAGE", "content": "안녕하세요!", ... },
            { "action": "JOIN", "content": "홍길동님이 참여했습니다.", ... }
        ],
        "hasMore": false
    }
}`,
                query: `// MongoDB
const logs = await ChatLog.find({ studyId }).sort({ timestamp: -1 }).limit(100);`
            }
        ]
    };

    const tabs = document.querySelectorAll('.tab-btn');
    const tabPanels = document.querySelectorAll('.tab-panel');

    // Set 'db-details' tab as active by default
    const defaultActiveTab = document.querySelector('[data-tab="db-details"]');
    if (defaultActiveTab) {
        defaultActiveTab.classList.add('active');
    }
    const defaultActivePanel = document.getElementById('db-details-content');
    if (defaultActivePanel) {
        defaultActivePanel.classList.remove('hidden');
    }

    tabs.forEach(tab => {
        tab.addEventListener('click', async () => {
            const tabName = tab.dataset.tab;

            tabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');

            tabPanels.forEach(panel => {
                if (panel.id === `${tabName}-content`) {
                    panel.classList.remove('hidden');
                } else {
                    panel.classList.add('hidden');
                }
            });

            if (tabName === 'erd') {
                try {
                    const erdContainer = document.querySelector('#erd-content .mermaid');
                    // Ensure the container is visible before attempting to render
                    erdContainer.style.display = 'block'; 
                    await mermaid.run({
                        nodes: [erdContainer]
                    });
                } catch (e) {
                    console.error("Mermaid rendering error:", e);
                }
            }
        });
    });

    function simpleJsonHighlight(jsonString) {
        if (!jsonString) return '';
        return jsonString.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, (match) => {
            let cls = 'json-number';
            if (/^"/.test(match)) {
                if (/:$/.test(match)) {
                    cls = 'json-key';
                } else {
                    cls = 'json-string';
                }
            } else if (/true|false/.test(match)) {
                cls = 'json-boolean';
            } else if (/null/.test(match)) {
                cls = 'json-null';
            }
            return `<span class="${cls}">${match}</span>`;
        });
    }

    function createAccordionItem(item, index) {
        const methodColorClass = {
            'POST': 'api-method-post',
            'GET': 'api-method-get',
            'DELETE': 'api-method-delete'
        }[item.method];

        return `
            <div class="border border-gray-200 rounded-lg">
                <button class="accordion-header w-full flex justify-between items-center p-4 text-left">
                    <div class="flex items-center space-x-4">
                        <span class="api-method ${methodColorClass}">${item.method}</span>
                        <span class="font-mono text-sm md:text-base text-gray-700">${item.endpoint}</span>
                        <span class="font-medium text-gray-800 hidden md:inline">- ${item.title}</span>
                    </div>
                    <svg class="accordion-header-icon w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-content">
                    <div class="p-5 border-t border-gray-200 bg-gray-50">
                        <p class="text-gray-600 mb-4">${item.description}</p>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-semibold mb-2">요청 (Request)</h4>
                                <pre class="bg-white p-3 rounded border"><code class="language-json">${simpleJsonHighlight(item.request)}</code></pre>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2">응답 (Response)</h4>
                                <pre class="bg-white p-3 rounded border"><code class="language-json">${simpleJsonHighlight(item.response)}</code></pre>
                            </div>
                            <div class="lg:col-span-2">
                                <h4 class="font-semibold mb-2">관련 쿼리 (Query)</h4>
                                <pre class="bg-white p-3 rounded border"><code class="language-sql">${item.query}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }

    Object.keys(apiData).forEach(key => {
        const container = document.querySelector(`#${key}-content .accordion-container`);
        if (container) {
            container.innerHTML = apiData[key].map(createAccordionItem).join('');
        }
    });

    document.querySelectorAll('.accordion-header').forEach(header => {
        header.addEventListener('click', () => {
            const content = header.nextElementSibling;
            const icon = header.querySelector('.accordion-header-icon');
            
            if (content.classList.contains('open')) {
                content.classList.remove('open');
                icon.style.transform = 'rotate(0deg)';
            } else {
                content.classList.add('open');
                icon.style.transform = 'rotate(180deg)';
            }
        });
    });
});
</script>

</body>
</html>
